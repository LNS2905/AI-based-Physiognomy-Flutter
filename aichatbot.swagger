{"swagger": "2.0", "basePath": "/api/v1", "paths": {"/chat/history/{conversation_id}": {"parameters": [{"name": "conversation_id", "in": "path", "required": true, "type": "integer"}], "get": {"responses": {"200": {"description": "Success"}}, "summary": "L\u1ea5y l\u1ecbch s\u1eed chat", "description": "L\u1ea5y l\u1ecbch s\u1eed h\u1ed9i tho\u1ea1i", "operationId": "get_chat_history", "tags": ["chat"]}}, "/chat/message": {"post": {"responses": {"200": {"description": "Success"}}, "summary": "G\u1eedi tin nh\u1eafn v\u00e0 nh\u1eadn ph\u1ea3n h\u1ed3i t\u1eeb Agent", "description": "G\u1eedi tin nh\u1eafn trong cu\u1ed9c h\u1ed9i tho\u1ea1i", "operationId": "post_chat_message", "parameters": [{"name": "payload", "required": true, "in": "body", "schema": {"$ref": "#/definitions/ChatMessage"}}], "tags": ["chat"]}}, "/chat/start": {"post": {"responses": {"200": {"description": "Success"}}, "summary": "B\u1eaft \u0111\u1ea7u cu\u1ed9c h\u1ed9i tho\u1ea1i m\u1edbi", "description": "B\u1eaft \u0111\u1ea7u cu\u1ed9c h\u1ed9i tho\u1ea1i m\u1edbi", "operationId": "post_chat_start", "parameters": [{"name": "payload", "required": true, "in": "body", "schema": {"$ref": "#/definitions/ChatStart"}}], "tags": ["chat"]}}, "/chat/user/{user_id}/conversations": {"parameters": [{"name": "user_id", "in": "path", "required": true, "type": "integer"}], "get": {"responses": {"200": {"description": "Success"}}, "summary": "L\u1ea5y danh s\u00e1ch conversation IDs c\u1ee7a user", "description": "L\u1ea5y danh s\u00e1ch conversation IDs c\u1ee7a user", "operationId": "get_user_conversations", "tags": ["chat"]}}, "/files": {"get": {"responses": {"200": {"description": "Success", "schema": {"type": "array", "items": {"$ref": "#/definitions/File"}}}}, "summary": "\ud83d\udcc1 L\u1ea5y danh s\u00e1ch file trong th\u01b0 m\u1ee5c test", "operationId": "list_files", "parameters": [{"name": "X-Fields", "in": "header", "type": "string", "format": "mask", "description": "An optional fields mask"}], "tags": ["default"]}}, "/tuvi/analyze": {"post": {"responses": {"500": {"description": "L\u1ed7i server", "schema": {"$ref": "#/definitions/Error"}}, "400": {"description": "File kh\u00f4ng h\u1ee3p l\u1ec7", "schema": {"$ref": "#/definitions/Error"}}, "200": {"description": "Success", "schema": {"$ref": "#/definitions/AnalysisResult"}}}, "summary": "\ud83d\udc0c C\u1ea2N C\u0168 - CH\u1eacM: Upload v\u00e0 lu\u1eadn gi\u1ea3i t\u1eeb h\u00ecnh \u1ea3nh/PDF (d\u00f9ng OCR + Vision)", "description": "**L\u01b0u \u00fd:** Endpoint n\u00e0y CH\u1eacM (50-100 gi\u00e2y). Ch\u1ec9 d\u00f9ng khi:\n- User \u0111\u00e3 c\u00f3 s\u1eb5n h\u00ecnh \u1ea3nh l\u00e1 s\u1ed1\n- Kh\u00f4ng th\u1ec3 d\u00f9ng API t\u1ea1o l\u00e1 s\u1ed1\n\n**Khuy\u1ebfn ngh\u1ecb:** D\u00f9ng /analyze-json thay th\u1ebf (nhanh g\u1ea5p 5 l\u1ea7n!)", "operationId": "analyze_upload", "parameters": [{"name": "file", "in": "formData", "type": "file", "required": true, "description": "File l\u00e1 s\u1ed1 t\u1eed vi (PDF ho\u1eb7c h\u00ecnh \u1ea3nh: JPG, PNG, JPEG)"}, {"name": "X-Fields", "in": "header", "type": "string", "format": "mask", "description": "An optional fields mask"}], "consumes": ["multipart/form-data"], "tags": ["tuvi"]}}, "/tuvi/analyze-json": {"post": {"responses": {"500": {"description": "L\u1ed7i server", "schema": {"$ref": "#/definitions/Error"}}, "400": {"description": "D\u1eef li\u1ec7u kh\u00f4ng h\u1ee3p l\u1ec7", "schema": {"$ref": "#/definitions/Error"}}, "200": {"description": "Success", "schema": {"$ref": "#/definitions/AnalysisResult"}}}, "summary": "\ud83d\ude80 ENDPOINT M\u1edaI - NHANH NH\u1ea4T: Lu\u1eadn gi\u1ea3i t\u1eeb JSON l\u00e1 s\u1ed1 (KH\u00d4NG C\u1ea6N OCR/VISION)", "description": "**Flow khuy\u1ebfn ngh\u1ecb:**\n1. Frontend g\u1ecdi: POST http://localhost:8000/charts v\u1edbi th\u00f4ng tin sinh\n2. Nh\u1eadn JSON response (c\u00f3 houses, stars, extra...)\n3. User nh\u1eadp c\u00e2u h\u1ecfi c\u1ea7n lu\u1eadn gi\u1ea3i\n4. G\u1eedi c\u1ea3 JSON response + c\u00e2u h\u1ecfi v\u00e0o endpoint n\u00e0y\n5. Nh\u1eadn k\u1ebft qu\u1ea3 tr\u1ea3 l\u1eddi c\u00e2u h\u1ecfi chi ti\u1ebft\n\n**Th\u1eddi gian:** 8-15 gi\u00e2y (nhanh g\u1ea5p 6 l\u1ea7n so v\u1edbi OCR+Vision!)\n\n**V\u00ed d\u1ee5 c\u00e2u h\u1ecfi:**\n- S\u1ef1 nghi\u1ec7p c\u1ee7a t\u00f4i nh\u01b0 th\u1ebf n\u00e0o?\n- N\u0103m nay t\u00f4i c\u00f3 t\u00ecnh duy\u00ean kh\u00f4ng?\n- T\u00f4i h\u1ee3p l\u00e0m ngh\u1ec1 g\u00ec?\n- S\u1ee9c kh\u1ecfe c\u1ee7a t\u00f4i c\u1ea7n l\u01b0u \u00fd g\u00ec?", "operationId": "analyze_json", "parameters": [{"name": "payload", "required": true, "in": "body", "schema": {"$ref": "#/definitions/ChartJsonInput"}}, {"name": "X-Fields", "in": "header", "type": "string", "format": "mask", "description": "An optional fields mask"}], "tags": ["tuvi"]}}, "/tuvi/analyze/{filename}": {"parameters": [{"name": "filename", "in": "path", "required": true, "type": "string"}], "get": {"responses": {"400": {"description": "File kh\u00f4ng \u0111\u1ecdc \u0111\u01b0\u1ee3c", "schema": {"$ref": "#/definitions/Error"}}, "404": {"description": "File kh\u00f4ng t\u1ed3n t\u1ea1i", "schema": {"$ref": "#/definitions/Error"}}, "200": {"description": "Success", "schema": {"$ref": "#/definitions/AnalysisResult"}}}, "summary": "\ud83d\udd0d Lu\u1eadn gi\u1ea3i file c\u00f3 s\u1eb5n trong th\u01b0 m\u1ee5c test (CH\u1eacM - d\u00f9ng OCR/Vision)", "operationId": "analyze_file", "parameters": [{"name": "X-Fields", "in": "header", "type": "string", "format": "mask", "description": "An optional fields mask"}], "tags": ["tuvi"]}}}, "info": {"title": "\ud83d\udd2e T\u1eed Vi API Pro - NHANH G\u1ea4P 5 L\u1ea6N", "version": "2.0", "description": "\nAPI lu\u1eadn gi\u1ea3i l\u00e1 s\u1ed1 t\u1eed vi v\u1edbi AI v\u00e0 RAG\n\n**\ud83d\ude80 C\u1ea2I TI\u1ebeN M\u1edaI:**\n- \u2705 Nh\u1eadn JSON t\u1eeb API l\u00e1 s\u1ed1 (NHANH - 12-20s)\n- \u2705 H\u1ed7 tr\u1ee3 OCR + Vision cho h\u00ecnh \u1ea3nh (CH\u1eacM - 50-100s)\n- \u2705 RAG v\u1edbi s\u00e1ch t\u1eed vi chuy\u00ean s\u00e2u\n- \u2705 Gemini AI lu\u1eadn gi\u1ea3i chi ti\u1ebft\n\n**\u26a1 FLOW KHUY\u1ebeN NGH\u1eca:**\n1. Frontend g\u1ecdi API t\u1ea1o l\u00e1 s\u1ed1: POST http://localhost:8000/charts\n2. Nh\u1eadn JSON response\n3. G\u1eedi JSON v\u00e0o endpoint /tuvi/analyze-json (NHANH G\u1ea4P 5 L\u1ea6N!)\n    "}, "produces": ["application/json"], "consumes": ["application/json"], "tags": [{"name": "default", "description": "Default namespace"}, {"name": "tuvi", "description": "\ud83d\udd2e T\u1eed vi operations"}, {"name": "chat", "description": "\ud83d\udcac Chat Agent operations"}], "definitions": {"File": {"required": ["filename"], "properties": {"filename": {"type": "string", "description": "T\u00ean file"}, "size": {"type": "string", "description": "K\u00edch th\u01b0\u1edbc file"}, "modified": {"type": "string", "description": "Ng\u00e0y s\u1eeda \u0111\u1ed5i"}}, "type": "object"}, "ChartJsonInput": {"required": ["chart_data", "question"], "properties": {"chart_data": {"type": "object", "description": "JSON l\u00e1 s\u1ed1 t\u1eeb API (to\u00e0n b\u1ed9 response object)", "example": {"id": 1, "request": {"day": 1, "month": 1, "year": 1990, "hour_branch": 1, "gender": 1, "name": "Test"}, "houses": [{"house_number": 1, "name": "M\u1ec7nh", "stars": []}], "extra": {"menh_chu": "V\u0169 kh\u00fac", "than_chu": "Thi\u00ean c\u01a1"}}}, "question": {"type": "string", "description": "C\u00e2u h\u1ecfi c\u1ea7n lu\u1eadn gi\u1ea3i (v\u00ed d\u1ee5: \"S\u1ef1 nghi\u1ec7p c\u1ee7a t\u00f4i nh\u01b0 th\u1ebf n\u00e0o?\", \"N\u0103m nay t\u00f4i c\u00f3 t\u00ecnh duy\u00ean kh\u00f4ng?\")", "example": "S\u1ef1 nghi\u1ec7p c\u1ee7a t\u00f4i nh\u01b0 th\u1ebf n\u00e0o?"}}, "type": "object"}, "Error": {"required": ["message"], "properties": {"message": {"type": "string", "description": "Th\u00f4ng b\u00e1o l\u1ed7i"}}, "type": "object"}, "AnalysisResult": {"required": ["analysis", "status", "timestamp"], "properties": {"filename": {"type": "string", "description": "T\u00ean file \u0111\u00e3 ph\u00e2n t\u00edch (n\u1ebfu c\u00f3)"}, "name": {"type": "string", "description": "T\u00ean ng\u01b0\u1eddi xem l\u00e1 s\u1ed1"}, "analysis": {"type": "string", "description": "K\u1ebft qu\u1ea3 lu\u1eadn gi\u1ea3i chi ti\u1ebft"}, "extracted_text": {"type": "string", "description": "Text \u0111\u00e3 tr\u00edch xu\u1ea5t/format t\u1eeb l\u00e1 s\u1ed1"}, "timestamp": {"type": "string", "description": "Th\u1eddi gian ph\u00e2n t\u00edch"}, "status": {"type": "string", "description": "Tr\u1ea1ng th\u00e1i"}, "method": {"type": "string", "description": "Ph\u01b0\u01a1ng ph\u00e1p: json/ocr+vision/pdf"}, "processing_time": {"type": "string", "description": "Th\u1eddi gian x\u1eed l\u00fd"}}, "type": "object"}, "ChatStart": {"required": ["user_id"], "properties": {"user_id": {"type": "integer", "description": "ID ng\u01b0\u1eddi d\u00f9ng"}, "chart_id": {"type": "integer", "description": "ID l\u00e1 s\u1ed1 (optional)"}}, "type": "object"}, "ChatMessage": {"required": ["conversation_id", "message"], "properties": {"conversation_id": {"type": "integer", "description": "ID cu\u1ed9c h\u1ed9i tho\u1ea1i"}, "message": {"type": "string", "description": "Tin nh\u1eafn"}}, "type": "object"}}, "responses": {"ParseError": {"description": "When a mask can't be parsed"}, "MaskError": {"description": "When any error occurs on mask"}}}